<script>
// == Beaker assets (0.1L scale) ==
(function (SVG) {
  function renderBeaker(opts){
    var W = opts.width  || 220;
    var H = opts.height || 260;
    var pad = {l:48, r:76, t:18, b:36};   // 左ラベル&右上注記用に広め
    var svg = SVG.svg(W, H);

    var cap = opts.capacityL ?? 1.0;      // 上限（L）
    var minorEvery = 0.1, midEvery = 0.5, majorEvery = 1.0;

    var x = pad.l, y = pad.t;
    var tankW = W - pad.l - pad.r, tankH = H - pad.t - pad.b;

    // 容器
    svg.appendChild(SVG.el('rect', {
      x:x, y:y, width:tankW, height:tankH, rx:12, ry:12,
      fill:'#ffffff', stroke:'#374151', 'stroke-width':1.8
    }));

    // 目盛（左）
    var ticksX = x - 10, labelX = x - 12;
    for (var v=0; v<=cap+1e-9; v+=minorEvery){
      var t = 1 - (v/cap);
      var yy = y + tankH * t;
      var len = 7;
      if (Math.abs(v % majorEvery) < 1e-9) len = 16;
      else if (Math.abs(v % midEvery) < 1e-9) len = 12;

      svg.appendChild(SVG.el('line', {x1:ticksX, y1:yy, x2:ticksX+len, y2:yy, stroke:'#111'}));

      // 0 / 0.5 / 1.0 / 1.5 … を表示（1.0 も必ず表示）
      var show = (Math.abs(v % midEvery) < 1e-9) || (Math.abs(v % majorEvery) < 1e-9);
      if (show){
        var txt = v.toFixed(1) + 'L';
        svg.appendChild(SVG.text(labelX, yy+4, txt, {'font-size':12, fill:'#111', 'text-anchor':'end'}));
      }
    }

    // 水
    if (opts.fillL != null){
      var h = tankH * (opts.fillL / cap);
      var fy = y + tankH - h;
      svg.appendChild(SVG.el('rect', {x:x+2, y:fy, width:tankW-4, height:h, rx:10, ry:10, fill:'#a7d1ff'}));
      svg.appendChild(SVG.el('line', {x1:x, y1:fy, x2:x+tankW, y2:fy, stroke:'#2563eb', 'stroke-width':2}));
    }

    // 注記（容器の外、右上）
    if (opts.note){
      svg.appendChild(SVG.text(x + tankW + 6, y + 12, opts.note, {'font-size':12, fill:'#374151', 'text-anchor':'start'}));
    }
    return svg;
  }

  // --- Assets ---
  SVG.register(function(spec){
    if (spec === 'beaker_dec_read_5' || spec === 'svg:beaker_dec_read_5'){
      return renderBeaker({capacityL:1.0, fillL:0.5, note:'1目もり=0.1L'});
    }
    if (spec === 'beaker_dec_read_13' || spec === 'svg:beaker_dec_read_13'){
      return renderBeaker({capacityL:1.5, fillL:1.3, note:'1目もり=0.1L'});
    }
    if (spec === 'beaker_dec_shade_0_7' || spec === 'svg:beaker_dec_shade_0_7'){
      // 位置線はUI側で。容器のみ表示。
      return renderBeaker({capacityL:1.0, note:'0.1Lごと'});
    }
    return null;
  });
})(window.SVG);
</script>
